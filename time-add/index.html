<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finish Time Calculator</title>
    <style>
      :root {
        --primary: #6366f1;
        --bg: #f8fafc;
        --card: #ffffff;
        --text: #1e293b;
      }

      body {
        font-family: system-ui, -apple-system, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }

      .container {
        background: var(--card);
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        width: 100%;
        max-width: 400px;
      }

      h1 {
        margin-top: 0;
        font-size: 1.5rem;
        text-align: center;
      }

      .input-group {
        margin-bottom: 1.5rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
      }

      input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #cbd5e1;
        border-radius: 6px;
        font-size: 1rem;
        box-sizing: border-box;
      }

      #result {
        margin-top: 2rem;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 8px;
        text-align: center;
        min-height: 3rem;
      }

      .time-display {
        font-size: 2rem;
        font-weight: bold;
        color: var(--primary);
        display: block;
      }
    </style>
  </head>

  <body>

    <div class="container">
      <h1>End Time Calculator</h1>

      <div class="input-group">
        <label for="startTime">Start Time</label>
        <input type="time" id="startTime" value="19:00">
      </div>

      <div class="input-group">
        <label for="duration">Duration (minutes)</label>
        <input type="number" id="duration" placeholder="e.g. 120" min="0">
      </div>

      <div id="result">
        Enter details to see end time
      </div>
    </div>

    <script>
      const startTimeInput = document.getElementById('startTime');
      const durationInput = document.getElementById('duration');
      const resultDiv = document.getElementById('result');

      // 1. On load, check URL for existing parameters
      window.addEventListener('load', () => {
        const params = new URLSearchParams(window.location.search);
        if (params.has('start')) startTimeInput.value = params.get('start');
        if (params.has('len')) durationInput.value = params.get('len');

        calculateEndTime();
      });

      function updateURL(start, len) {
        const params = new URLSearchParams();
        if (start) params.set('start', start);
        if (len) params.set('len', len);

        // Update URL without refreshing the page
        const newRelativePathQuery = window.location.pathname + '?' + params.toString();
        history.replaceState(null, '', newRelativePathQuery);
      }

      function calculateEndTime() {
        const startTime = startTimeInput.value;
        const duration = parseInt(durationInput.value);

        // Update the URL every time an input changes
        updateURL(startTime, durationInput.value);

        if (!startTime || isNaN(duration)) {
          resultDiv.innerHTML = "Enter details to see end time";
          return;
        }

        const [hours, minutes] = startTime.split(':').map(Number);
        const date = new Date();
        date.setHours(hours);
        date.setMinutes(minutes + duration);

        const endHours = date.getHours().toString().padStart(2, '0');
        const endMinutes = date.getMinutes().toString().padStart(2, '0');

        // Optional: Check if it ends on a different day
        const isNextDay = date.getDate() !== new Date().getDate();
        const dayLabel = isNextDay ? ' <small>(Next Day)</small>' : '';

        resultDiv.innerHTML = `
            <span>Finish Time:</span>
            <span class="time-display">${endHours}:${endMinutes}${dayLabel}</span>
        `;
      }

      startTimeInput.addEventListener('input', calculateEndTime);
      durationInput.addEventListener('input', calculateEndTime);
    </script>

  </body>

</html>